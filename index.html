<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>LyraX v2 | Secure</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #020205; color: white; font-family: 'Inter', sans-serif; }
        .blue-glow { box-shadow: 0 0 50px rgba(0, 210, 255, 0.2); }
        .glass { background: rgba(0, 15, 35, 0.85); backdrop-filter: blur(20px); border-radius: 3rem; }
    </style>
</head>
<body class="flex items-center justify-center h-screen bg-[radial-gradient(circle_at_top,#001a33,transparent)]">

    <div id="auth-box" class="glass w-full max-w-sm p-10 blue-glow z-50">
        <h1 class="text-center font-black text-cyan-400 mb-8 uppercase tracking-widest">LyraX OS Login</h1>
        <input id="email" type="email" placeholder="Email" class="w-full bg-white/5 border border-white/10 rounded-2xl px-4 py-3 mb-4 outline-none focus:border-cyan-500">
        <input id="pass" type="password" placeholder="Password" class="w-full bg-white/5 border border-white/10 rounded-2xl px-4 py-3 mb-6 outline-none focus:border-cyan-500">
        <button onclick="auth('login')" class="w-full bg-cyan-500 text-black py-4 rounded-2xl font-black mb-4">LOG IN</button>
        <button onclick="auth('signup')" class="w-full text-cyan-400 text-xs font-bold uppercase tracking-widest">Create Account</button>
    </div>

    <div id="player-ui" class="hidden glass w-full max-w-sm p-8 blue-glow">
        <div class="flex gap-2 mb-6">
            <input id="q" type="text" placeholder="Search track..." class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-2 text-sm">
            <button onclick="search()" class="bg-cyan-500 text-black px-4 rounded-xl font-bold">GO</button>
        </div>
        <div id="results" class="h-40 overflow-y-auto mb-6 space-y-2"></div>
        <div class="text-center">
            <img id="art" src="https://via.placeholder.com/300/020205/00d2ff" class="w-32 h-32 mx-auto rounded-3xl mb-4 shadow-xl">
            <h2 id="name" class="font-bold truncate">Select Track</h2>
            <audio id="player" controls class="w-full mt-4 opacity-40"></audio>
        </div>
    </div>

    <script>
        const BACKEND = "https://lyrax-backend.onrender.com";
        let token = localStorage.getItem('lyrax_token');

        if(token) showPlayer();

        async function auth(type) {
            const email = document.getElementById('email').value;
            const password = document.getElementById('pass').value;
            const res = await fetch(`${BACKEND}/auth/${type}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });
            const data = await res.json();
            if(data.token) {
                localStorage.setItem('lyrax_token', data.token);
                showPlayer();
            } else { alert(data.message || data.error); }
        }

        function showPlayer() {
            document.getElementById('auth-box').classList.add('hidden');
            document.getElementById('player-ui').classList.remove('hidden');
        }

        async function search() {
            const res = await fetch(`${BACKEND}/api/search?q=${document.getElementById('q').value}`, {
                headers: { 'Authorization': `Bearer ${localStorage.getItem('lyrax_token')}` }
            });
            const tracks = await res.json();
            // ... (Same list rendering as before)
        }
        
        async function play(t) {
            const res = await fetch(`${BACKEND}/api/stream?title=${t.name}&artist=${t.artists.items[0].profile.name}`, {
                headers: { 'Authorization': `Bearer ${localStorage.getItem('lyrax_token')}` }
            });
            const data = await res.json();
            const audio = document.getElementById('player');
            audio.src = data.url; audio.play();
        }
    </script>
</body>
</html>
